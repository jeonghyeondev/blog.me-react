{"ast":null,"code":"import _slicedToArray from\"/Users/jeonghyeon/Desktop/kjh/dev/blog-react/blog-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{changeField,initializeForm,register}from'../../modules/auth';import AuthForm from'../../components/auth/AuthForm';import{check}from'../../modules/user';import{withRouter}from'react-router-dom';var RegisterForm=function RegisterForm(_ref){var history=_ref.history;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var dispatch=useDispatch();var _useSelector=useSelector(function(_ref2){var auth=_ref2.auth,user=_ref2.user;return{form:auth.register,auth:auth.auth,authError:auth.authError,user:user.user};}),form=_useSelector.form,auth=_useSelector.auth,authError=_useSelector.authError,user=_useSelector.user;// 인풋 변경 핸들러\nvar onChange=function onChange(e){var _e$target=e.target,value=_e$target.value,name=_e$target.name;dispatch(changeField({form:'register',key:name,value:value}));};// 폼 등록 이벤트 핸들러\nvar onSubmit=function onSubmit(e){e.preventDefault();var username=form.username,password=form.password,passwordConfirm=form.passwordConfirm;// 하나라도 비어 있다면\nif([username,password,passwordConfirm].includes('')){setError('빈 칸을 모두 입력하세요.');return;}// 비밀번호가 일치하지 않는다면\nif(password!==passwordConfirm){setError('비밀번호가 일치하지 않습니다.');dispatch(changeField({form:'register',key:'password',value:''}));dispatch(changeField({form:'register',key:'passwordConfirm',value:''}));return;}dispatch(register({username:username,password:password}));};// 컴포넌트가 처음 렌덩링될 때 form 초기화함\nuseEffect(function(){dispatch(initializeForm('register'));},[dispatch]);// 회원가입 성공/실패 처리\nuseEffect(function(){if(authError){// 계정명이 이미 존재할 때\nif(authError.response.status===409){setError('이미 존재하는 계정명입니다.');return;}// 기타이유\nsetError('회원가입 실패');return;}if(auth){console.log('회원가입 성공');console.log(auth);dispatch(check());}},[auth,authError,dispatch]);// user 값이 잘 설정되었는지 확인\nuseEffect(function(){if(user){history.push('/');// 홈 화면으로 이동\ntry{localStorage.setItem('user',JSON.stringify(user));}catch(e){console.log('localStorage is not working');}}},[history,user]);return/*#__PURE__*/_jsx(AuthForm,{type:\"register\",form:form,onChange:onChange,onSubmit:onSubmit,error:error});};export default withRouter(RegisterForm);","map":{"version":3,"sources":["/Users/jeonghyeon/Desktop/kjh/dev/blog-react/blog-frontend/src/containers/auth/RegisterForm.js"],"names":["React","useEffect","useState","useDispatch","useSelector","changeField","initializeForm","register","AuthForm","check","withRouter","RegisterForm","history","error","setError","dispatch","auth","user","form","authError","onChange","e","target","value","name","key","onSubmit","preventDefault","username","password","passwordConfirm","includes","response","status","console","log","push","localStorage","setItem","JSON","stringify"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { changeField, initializeForm, register } from '../../modules/auth';\nimport AuthForm from '../../components/auth/AuthForm';\nimport { check } from '../../modules/user';\nimport { withRouter } from 'react-router-dom';\n\nconst RegisterForm = ({ history }) => {\n  const [error, setError] = useState(null);\n  const dispatch = useDispatch();\n  const { form, auth, authError, user } = useSelector(({ auth, user }) => ({\n    form: auth.register,\n    auth: auth.auth,\n    authError: auth.authError,\n    user: user.user,\n  }));\n\n  // 인풋 변경 핸들러\n  const onChange = (e) => {\n    const { value, name } = e.target;\n    dispatch(\n      changeField({\n        form: 'register',\n        key: name,\n        value,\n      }),\n    );\n  };\n\n  // 폼 등록 이벤트 핸들러\n  const onSubmit = (e) => {\n    e.preventDefault();\n    const { username, password, passwordConfirm } = form;\n    // 하나라도 비어 있다면\n    if ([username, password, passwordConfirm].includes('')) {\n      setError('빈 칸을 모두 입력하세요.');\n      return;\n    }\n    // 비밀번호가 일치하지 않는다면\n    if (password !== passwordConfirm) {\n      setError('비밀번호가 일치하지 않습니다.');\n      dispatch(changeField({ form: 'register', key: 'password', value: '' }));\n      dispatch(\n        changeField({ form: 'register', key: 'passwordConfirm', value: '' }),\n      );\n      return;\n    }\n    dispatch(register({ username, password }));\n  };\n\n  // 컴포넌트가 처음 렌덩링될 때 form 초기화함\n  useEffect(() => {\n    dispatch(initializeForm('register'));\n  }, [dispatch]);\n\n  // 회원가입 성공/실패 처리\n  useEffect(() => {\n    if (authError) {\n      // 계정명이 이미 존재할 때\n      if (authError.response.status === 409) {\n        setError('이미 존재하는 계정명입니다.');\n        return;\n      }\n      // 기타이유\n      setError('회원가입 실패');\n      return;\n    }\n    if (auth) {\n      console.log('회원가입 성공');\n      console.log(auth);\n      dispatch(check());\n    }\n  }, [auth, authError, dispatch]);\n\n  // user 값이 잘 설정되었는지 확인\n  useEffect(() => {\n    if (user) {\n      history.push('/'); // 홈 화면으로 이동\n      try {\n        localStorage.setItem('user', JSON.stringify(user));\n      } catch (e) {\n        console.log('localStorage is not working');\n      }\n    }\n  }, [history, user]);\n\n  return (\n    <AuthForm\n      type=\"register\"\n      form={form}\n      onChange={onChange}\n      onSubmit={onSubmit}\n      error={error}\n    ></AuthForm>\n  );\n};\n\nexport default withRouter(RegisterForm);\n"]},"metadata":{},"sourceType":"module"}